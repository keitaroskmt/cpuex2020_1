# cpuex2020_1 2stCPU 用コンパイラ

### メモ

サイズ128のコンテスト用プログラムでコンパイル, 及びシミュレーションの結果が正しいことを確認. 
```
$ ./raytracer.sh 128
```

Makefileで特定のファイルをコンパイルするようにしたのち, それらのテストケースに対し結果の確認を行う. 
```
$ ./test.sh
```


### min-camlからの改造点
- インライン展開 (再帰関数はサイズ50, それ以外はサイズ300)
- グローバル変数のアドレス固定 -> クロージャの削除
- レジスタ彩色, moveのcoalescing ('Appel, modern compiler implementation in ML'参考)
- 共通部分式削除 (タプルの展開についても行う)
- 仮想マシンコードの定数畳み込み, 不要定義削除
- 分岐, ジャンプのラベルをたどり, 無駄なジャンプを削除
- 定数レジスタの実装
- 覗き穴最適化
- アセンブリ関数のループアンローリング
- アセンブリレベルで見た無駄なスタックポインタの操作の削除
