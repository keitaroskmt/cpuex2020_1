# cpuex2020_1 1stCPU 用 FPU

## memo

3clock 以下 100MHz で動き、チェックを通ったもの

10/18 fadd 3clock 9.785ns
10/18 fsub 3clock 10.072ns
間に合ってないけど治らないのでとりあえずこれで
10/18 fmul 2clock 7.131ns
非正規化数とかゼロ周りが怪しいのでまだ改善する必要がある
10/20
組み合わせ回路で fneg, fabs を実装
10/25
finv の table を書いてみた
また、それを用いて finv の処理を python でエミュレートした
一応誤差は+-3ulp に収まった
10/26
0 の挙動をちゃんと決めないといけない
「指数部が 0 なら 0 として扱う」としているが、
入力が指数部 0、仮数部 m の演算のとき、指数部 0、仮数部 0 として演算するのか、指数部 0、仮数部 m として演算したのち出力をいじるのか、どうするか決めた方が良い。
10/27
finv 2clock 6.785ns
シミュレータで動いたのは見たが、全数検査はしたほうがいいかも
テストベンチを解読して書く
fmove を組み合わせ回路で実装
10/31
fmul を仕様に従って修正
正規化数が入力のとき正しく動くことを確認
fmul 2clock 9.119ns
finv を正しく動くよう修正
table を微調整
指数部と符号を固定して全数検査済み
finv 2clock 8.303ns
fdiv について，finv→fmul だが，finv の出力が非正規化数のときについて，要検討
もしかすると fmul は非正規化数にも対応する必要があるかもしれない ← future work
それ以外はちゃんと動く
y を直接吐き出したら怒られたので、1 つレジスタを噛ませるようにした
fdiv 5clock 9.508ns

仕様
入力が非正規化数の場合は捨ててよい
出力が非正規化数の場合はそのまま出す
